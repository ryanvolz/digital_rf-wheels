env:
    global:
        - PROJECT_SPEC="digital_rf==2.6.0b3"
        # pip dependencies to _build_ your project
        - NP_BUILD_DEP="1.7.1"
        - BUILD_DEPENDS="pkgconfig setuptools wheel"
        # pip dependencies to _test_ your project, beyond the setup.py install
        # dependencies and potentially including specific versions
        - TEST_DEPENDS="pytest"
        # default platform (typically overridden in matrix)
        - PLAT=x86_64
        # default unicode width (typically overridden in matrix)
        - UNICODE_WIDTH=32
        # Note: TWINE_USERNAME and TWINE_PASSWORD are set in Travis settings

language: python
# The travis Python version is unrelated to the version we build and test
# with.  This is set with the MB_PYTHON_VERSION variable.
python: 3.5
sudo: required
dist: trusty
services: docker

matrix:
  exclude:
    # Exclude the default Python build
    - python: 3.5
  include:
    - os: linux
      env:
        - MB_PYTHON_VERSION=2.7
    - os: linux
      env:
        - MB_PYTHON_VERSION=2.7
        - UNICODE_WIDTH=16
    - os: linux
      env:
        - MB_PYTHON_VERSION=2.7
        - PLAT=i686
    - os: linux
      env:
        - MB_PYTHON_VERSION=2.7
        - PLAT=i686
        - UNICODE_WIDTH=16
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.4
#        - NP_BUILD_DEP="1.7.1"
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.4
#        - PLAT=i686
#        - NP_BUILD_DEP="1.7.1"
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.5
#        - NP_BUILD_DEP="1.9.3"
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.5
#        - PLAT=i686
#        - NP_BUILD_DEP="1.9.3"
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.6
#        - NP_BUILD_DEP="1.11.3"
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.6
#        - PLAT=i686
#        - NP_BUILD_DEP="1.11.3"
    - os: osx
      language: generic
      env:
        - MB_PYTHON_VERSION=2.7
#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.4
#        - NP_BUILD_DEP="1.7.1"
#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.5
#        - NP_BUILD_DEP="1.9.3"
#    - os: osx
#      language: generic
#      env:
#        - MB_PYTHON_VERSION=3.6
#        - NP_BUILD_DEP="1.11.3"

before_install:
    - BUILD_DEPENDS="numpy==$NP_BUILD_DEP $BUILD_DEPENDS"
    - source multibuild/common_utils.sh
    - source multibuild/travis_steps.sh
    - before_install

install:
    # fetch and unpack source package
    - source prepare.sh
    - fetch_unpack_index $PROJECT_SPEC src
    # build wheels
    - build_wheel src
    - ls $WHEEL_SDIR/*

script:
    # run tests
    - install_run $PLAT

after_success:
    # Upload wheels to PyPI
    - python -m pip install twine
    - python -m twine upload --skip-existing $WHEEL_SDIR/*
